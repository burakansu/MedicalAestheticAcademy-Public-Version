@model List<Advisor>
@{
    int advisorId = 0;

    if (Model.Count() > 0)
    {
        advisorId = @Model.First().AdvisorId;
    }
}
<div class="rbt-breadcrumb-default ptb--100 ptb_md--50 ptb_sm--30 bg-gradient-1">
    <div class="container">
        <div class="row">
            <div class="col-lg-12">
                <div class="breadcrumb-inner text-center">
                    @if (Model.Count > 0)
                    {
                        <h2 class="title">Danışmanlık</h2>
                    }
                    else
                    {
                        <h2 class="title">Danışmanlık Hizmetiniz Bulunmamaktadır</h2>
                    }
                    <ul class="page-list">
                        <li class="rbt-breadcrumb-item"><a>Anasayfa</a></li>
                        <li>
                            <div class="icon-right"><i class="feather-chevron-right"></i></div>
                        </li>
                        <li class="rbt-breadcrumb-item active">Danışmanlık Ve Hizmetlerim</li>
                    </ul>
                </div>
            </div>
        </div>
    </div>
</div>

@if (Model.Count > 0)
{
    <!-- End Breadcrumb Area -->
    <div class="my-account-section bg-color-white rbt-section-gap">
        <div class="container">
            <div class="row">
                <div class="col-12">
                    <div class="row g-5">



                        <!-- My Account Tab Menu Start -->
                        <div class="col-lg-3 col-12">
                            <div class="rbt-my-account-tab-button nav" role="tablist">
                                @foreach (var item in Model)
                                {
                                    <a class="advisor-link" data-lecturerid="@item.LecturerId" data-advisorid="@item.AdvisorId">@item.Name</a>
                                }
                            </div>
                        </div>
                        <!-- My Account Tab Menu End -->



                        <!-- My Account Tab Content Start -->
                        <div class="col-lg-9 col-12">
                            <div class="tab-content" id="myaccountContent">


                                <!-- Single Tab Content Start -->
                                <div class="tab-pane fade active show" id="dashboad" role="tabpanel">
                                    <div class="rbt-my-account-inner" id="chats">




                                    </div>
                                </div>
                                <!-- Single Tab Content End -->


                            </div>
                        </div>
                        <!-- My Account Tab Content End -->
                    </div>

                </div>

            </div>
        </div>
    </div>
}

<div class="rbt-separator-mid">
    <div class="container">
        <hr class="rbt-separator m-0">
    </div>
</div>

<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
<script>
    $(document).ready(function () {
        function loadChat(advisorId) {
            $.ajax({
                url: '/AdvisorUi/MyAdvisorChat',
                type: 'GET',
                data: {
                    AdvisorId: advisorId
                },
                success: function (response) {
                    $('#chats').html(response);
                },
                error: function (xhr, status, error) {
                    console.log(error);
                    Swal.fire({
                        icon: 'error',
                        title: 'Hata',
                        text: 'İstek sırasında bir hata oluştu.'
                    });
                }
            });
        }

        var advisorId = '@advisorId';
        if (advisorId && advisorId !== '0') {
            loadChat(advisorId);
        } else if (advisorId === '0') {
            Swal.fire({
                icon: 'info',
                title: 'Uyarı',
                text: 'Danışmanlık hizmeti satın alınmamış.'
            });
        }

        $('.advisor-link').click(function () {
            var advisorId = $(this).data('advisorid');
            if (advisorId !== '0') {
                loadChat(advisorId);
            }
        });
    });


</script>

