@{
    int CookieCustomerId = MetaData.baseCustomerId();
    var Model = MetaData.baseLesson().Single(x => x.LessonId == ViewBag.LessonId);
    var course = MetaData.baseCourse().Single(x => x.CourseId == Model.CourseId);
    var customerlesson = MetaData.baseCustomerLessonRelation();
    var customerlessonrelations = MetaData.baseCustomerLessonRelation().Where(x => x.CustomerId == CookieCustomerId);
    string color = "color:#192d90";
}

<div class="rbt-lesson-area bg-color-white">
    <div class="rbt-lesson-content-wrapper">
        <div class="rbt-lesson-leftsidebar">
            <div class="rbt-course-feature-inner rbt-search-activation">
                <div class="section-title">
                    <h4 class="rbt-title-style-3">@course.Name</h4>
                </div>


                <div class="rbt-accordion-style rbt-accordion-02 accordion p-5">
                    <div class="accordion" id="accordionExampleb2">



                        <div class="accordion-item card">
                            <h2 class="accordion-header card-header" id="headingTwo1">
                                <button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#collapseTwo1" aria-expanded="true" aria-controls="collapseTwo1">
                                    Kurs Fragmanları <span class="rbt-badge-5 ml--10">Önizleme</span>
                                </button>
                            </h2>
                            <div id="collapseTwo1" class="accordion-collapse collapse show" aria-labelledby="headingTwo1" data-bs-parent="#accordionExampleb2">
                                <div class="accordion-body card-body pr--0">
                                    <ul class="rbt-course-main-content liststyle">


                                        @foreach (var item in course.Trailer)
                                        {
                                            <li>
                                                <a target="_blank" href="@item.Source">
                                                    <div class="course-content-left">
                                                        <i class="feather-play-circle"></i> <span class="text">@item.Name</span>
                                                    </div>
                                                    <div class="course-content-right">
                                                        <span class="min-lable">1 dk</span>
                                                        <span class="rbt-badge variation-03 bg-primary-opacity"><i class="feather-eye"></i> Önizle</span>
                                                    </div>
                                                </a>
                                            </li>
                                        }


                                    </ul>
                                </div>
                            </div>
                        </div>

                        <div class="accordion-item card">
                            <h2 class="accordion-header card-header" id="headingTwo2">
                                <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseTwo2" aria-expanded="false" aria-controls="collapseTwo2">
                                    Kurs Dersleri <span class="rbt-badge-5 ml--10">0 dk</span>
                                </button>
                            </h2>
                            <div id="collapseTwo2" class="accordion-collapse collapse" aria-labelledby="headingTwo2" data-bs-parent="#accordionExampleb2">
                                <div class="accordion-body card-body pr--0">
                                    <ul class="rbt-course-main-content liststyle">


                                        @foreach (var item in course.Lesson)
                                        {
                                            color = "color:#192335";

                                            if (customerlessonrelations.Where(x => x.LessonId == item.LessonId).Count() > 0)
                                            {
                                                if (Model.LessonId == item.LessonId)
                                                {
                                                    color = "color:#2f57ef";
                                                }

                                                <li>
                                                    <a asp-action="ViewCourse" asp-controller="CourseUi" asp-route-lessonid="@item.LessonId" style="@color;">
                                                        <div class="course-content-left">
                                                            <i class="feather-play-circle"></i> <span class="text">@item.Name</span>
                                                        </div>
                                                        <div class="course-content-right">
                                                            <span class="min-lable">@item.Duration dk</span>

                                                            @if (MetaData.baseCustomerLessonRelation().FirstOrDefault(x => x.CustomerId == CookieCustomerId && x.LessonId == item.LessonId).Completed == 1)
                                                            {
                                                                <span class="min-lable"><i class="fa-solid fa-square-check"></i></span>
                                                            }
                                                            else
                                                            {
                                                                <span class="min-lable"><i class="fa-regular fa-square"></i></span>
                                                            }

                                                        </div>
                                                    </a>
                                                </li>
                                            }
                                            else
                                            {
                                                <li>
                                                    <a>
                                                        <div class="course-content-left">
                                                            <i class="feather-play-circle"></i> <span class="text">@item.Name</span>
                                                        </div>
                                                        <div class="course-content-right">
                                                            <span class="min-lable">@item.Duration dk</span>
                                                            <span class="course-lock"><i class="feather-lock"></i></span>
                                                        </div>
                                                    </a>
                                                </li>
                                            }
                                        }


                                    </ul>
                                </div>
                            </div>
                        </div>



                    </div>
                </div>



            </div>
        </div>

        <div class="rbt-lesson-rightsidebar overflow-hidden lesson-video">
            <div class="inner">
                <div class="plyr__video-embed rbtplayer">
                    <div style="position: relative; padding-top: 56.25%;">
                        <iframe src="@Model.Source"
                                loading="lazy" style="border: none; position: absolute; top: 0; height: 100%; width: 100%;"
                                allow="accelerometer; gyroscope; autoplay; encrypted-media; picture-in-picture;" allowfullscreen="true">
                        </iframe>
                    </div>
                </div>
            </div>

            <div class="content">
                <div class="section-title">
                    <h4>@Model.Name</h4>
                    <p>@Model.Description</p>
                </div>
            </div>

        </div>
    </div>
</div>


<div class="rbt-progress-parent">
    <svg class="rbt-back-circle svg-inner" width="100%" height="100%" viewBox="-1 -1 102 102">
        <path d="M50,1 a49,49 0 0,1 0,98 a49,49 0 0,1 0,-98" />
    </svg>
</div>
